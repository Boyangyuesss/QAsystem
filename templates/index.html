<!DOCTYPE HTML>
<html>
<head>
<title>File upload</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- Bootstrap Core CSS -->
 {% load static %}
<link href="/static/css/bootstrap.min.css" rel='stylesheet' type='text/css' />
<!-- Custom CSS -->
<link href="/static/css/style.css" rel='stylesheet' type='text/css' />
<!-- Graph CSS -->
<link href="/static/css/font-awesome.css" rel="stylesheet">
<!-- jQuery -->
<link href='https://fonts.googleapis.com/css?family=Roboto:700,500,300,100italic,100,400' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
<!-- lined-icons -->
<link rel="stylesheet" href="{% static 'css/icon-font.min.css' %}" type='text/css' />
<link rel="stylesheet" href="/static/css/buttons.css" type="text/css"/>
<!-- <script src="js/amcharts.js"></script>	
<script src="js/serial.js"></script>	
<script src="js/light.js"></script>	 -->
<!-- //lined-icons -->
<script src="{% static 'js/jquery-1.10.2.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>

{#    <script src="/static/js/jquery-1.10.2.min.js"></script>#}
{#    <script src="/static/js/bootstrap.min.js"></script>#}

{#    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">#}
{#	<script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>#}
{#	<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>#}
<!--文件上传插件-->

<link href="/static/css/fileinput(1).css" media="all" rel="stylesheet" type="text/css" />
<script src="/static/js/jquery-2.0.3.min.js"></script>
<script src="/static/js/fileinput(1).js" type="text/javascript"></script>
{#<script src="/static/js/zh.js" type="text/javascript"></script>#}

    <!-- 等待时的框-->
    <link href="/static/css/loaders.css" rel="stylesheet" type="text/css" />
    <style>
        label{
            font-size: 85%;
        }
        .form-control.model{
            height: 23px;
        }
        .form-group{
            margin-bottom: 8px;
        }
        .modal-body{
            padding: 8px;
        }
        .modal-footer{
            padding: 10px;
        }
        .modal-dialog{
            margin-top: 0px;
        }
        .line-scale-pulse-out-rapid > div{
            background-color: #333;
        }
    </style>
</head> 
<body>
   <div class="page-container">
   <!--/content-inner-->
	<div class="left-content">
	   <div class="inner-content">
		<!-- header-starts -->
			<div class="header-section">
			<!-- top_bg -->
						<div class="top_bg">
							
								<div class="header_top">
									<div class="top_left" style="margin-bottom:1% ">
										<h2><span></span> Contact Us：JI CSIT998 Group 5</h2>
									</div>
										<div class="clearfix"> </div>
								</div>
							
						</div>
					<div class="clearfix"></div>
				<!-- /top_bg -->
				</div>
				<!--header_bg-->
				<div class="header_bg">
						
							<div class="header">
								<div class="head-t">
									<div class="logo">
										<a href="../index"><img src="{% static 'img/logo.png' %}" class="img-responsive" alt=""> </a>
{#										<a href="../index"><img src=G:\桌面\998\QAsystem-master\QAManagement\static\img" class="img-responsive" alt=""> </a>#}
{#                                        <a href="#" class="button button-action button-pill" style="margin-top: 1em">Go</a>#}
									</div>
										<!-- start header_right -->
								<div class="clearfix"> </div>
							</div>
						</div>
					
				</div>
				<!--/header_bg-->
				<!--content-->
				<div id="content" style="height:500px">
{#					<div class="case" style="position:relative;margin:auto;margin-top:5%">#}
{#						<div class="upload" action='/index' data-num='1' data-type="doc,docx" data-file="file" id='case2'></div>#}
                    <form enctype="multipart/form-data" style="margin: auto;margin-left: 5%;margin-right: 5%" id="fileupload">
                        <br>
                        <div class="form-group">
                            <input id="file-1" type="file" name="file" multiple class="file" data-overwrite-initial="false" data-min-file-count="1" >
                        </div>
                    </form>
                   <!-- <div>
                    <a href="#" class="button button-action button-pill" style="float:left;margin-left: 5%;background-color: #333333;color:#FFF" id="doexe">运行</a>
{#                     <div id="pointer" style="background-image: url('/static/img/pointer.png');"></div>#}
                        <img src="/static/img/pointer.png" style="float: left;">
                    </div>-->

                </div>
       </div>
			<!--/sidebar-menu-->
				<div class="sidebar-menu">
    <header class="logo1">
        <a href="#" class="sidebar-icon"> <span class="fa fa-bars"></span> </a>
    </header>
    <div style="border-top:1px ridge rgba(255, 255, 255, 0.15)"></div>
                    <div class="menu">
                        <ul id="menu">
                            <li><a href="../index/"><i class="lnr lnr-cloud-upload"></i> <span>File upload</span></a></li>
                            <li id="menu-academico" ><a href="/Task"><i class="lnr lnr-layers"></i> <span>QA pair generation</span></a></li>
                            <li id="menu-academico"><a href="/QAManage"><i class="fa fa-table"></i>
                                <span> QA pair management</span></a>
                            </li>
                            <!--<li id="menu-academico" ><a href="#"><i class="lnr lnr-layers"></i> <span>Tabs & Calender</span> <span class="fa fa-angle-right" style="float: right"></span></a>-->
                            <!--<ul id="menu-academico-sub" >-->
                            <!--<li id="menu-academico-avaliacoes" ><a href="#">Tabs</a></li>-->
                            <!--<li id="menu-academico-boletim" ><a href="#">Calender</a></li>-->
                            <!--</ul>-->
                            <!--</li>-->
                            <li><a href="http://127.0.0.1:5601" target="_blank"><i class="lnr lnr-chart-bars"></i>
                                <span>Data visualization</span> </a>
                            </li>
                            <li><a href="/userMining"><i class="lnr lnr-user"></i>
                                <span>User information</span> </a>
                            </li>
                            <!--<ul>-->
                            <!--<li><a href="#"> Input</a></li>-->
                            <!--<li><a href="#">Validation</a></li>-->
                            <!--</ul>-->
                        </ul>
                    </div>
</div>
							  <div class="clearfix"></div>		
							</div>
    </div>


   <!--选择需要解析的HTML的Model-->
    <!--<div class="modal fade" id="choose_file" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
              <h4 class="modal-title">选择需要生成QA对的网页</h4>
          </div>
          <div class="modal-body" id="file_body">
              <a style="color:#333;cursor:pointer" class="filemodel" onclick="checkfile(this)">
                  <img src="/static/img/file.png">
                  <div class="file-caption-info" style="font-size:15px"></div>
              </a>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-primary Doexe" data-dismiss="modal">下一步</button>
          </div>
        </div>
      </div>
    </div>-->

   <!--选择模板的Model-->
   <!--<div class="modal fade" id="Doexe" tabindex="-1" role="dialog" aria-hidden="true">
       <div class="modal-dialog">
           <div class="modal-content">
               <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                   <h4 class="modal-title">请选择已有的网页抽取模板</h4>
               </div>
               <div class="modal-body" id="model_body">
                   <a style="color:#333;cursor:pointer" class="filemodel" onclick="checkfile(this)">
                       <img src="/static/img/model.png">
                       <div class="file-caption-info" style="font-size:15px">华为云网页抽取模版</div>
                   </a>
               </div>
               <div class="modal-footer">
                   <button type="button" class="btn btn-default createModel" data-dismiss="modal">新建网页抽取模版</button>
                   <button type="button" class="btn btn-primary Do" data-dismiss="modal">生成</button>
               </div>
           </div>
       </div>
   </div>-->

{#   <div class="modal fade" id="choose_file" tabindex="-1" role="dialog" aria-hidden="true">#}
{#       <div class="modal-dialog">#}
{#           <div class="modal-content">#}
{#               <div class="modal-header">#}
{#                   <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>#}
{#                   <h4 class="modal-title">选择需要生成QA对的网页</h4>#}
{#               </div>#}
{#               <div class="modal-body">#}
{#                   <a style="color:#333;cursor:pointer" class="filemodel" onclick="checkfile(this)">#}
{#                       <img src="/static/img/model.png"></img>#}
{#                       <div class="file-caption-info" style="font-size:15px"></div>#}
{#                   </a>#}
{#               </div>#}
{#               <div class="modal-footer">#}
{#                   <button type="button" class="btn btn-default createModel" data-dismiss="modal">取消</button>#}
{#                   <button type="button" class="btn btn-primary Do" data-dismiss="modal">下一步</button>#}
{#               </div>#}
{#           </div>#}
{#       </div>#}
{#   </div>#}
<!--创建模板的Modal-->
  <!-- <div class="modal fade" id="createModel" tabindex="-1" role="dialog" aria-hidden="true">
       <div class="modal-dialog">
           <div class="modal-content">
               <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                   <h4 class="modal-title">新建网页抽取模板</h4>
               </div>
               <div class="modal-body">
                   <form role="form">
                       <div class="form-group">
                           <label for="id">网页标题开头特征</label>
                           <input type="text" class="form-control model" id="begintitle" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="name">网页标题结尾特征</label>
                           <input type="text" class="form-control model" id="endtitle" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="tel">网页小标题开头特征</label>
                           <input type="tel" class="form-control model" id="littlebegintitle" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="exampleInputEmail1">网页小标题结尾特征</label>
                           <input type="email" class="form-control model" id="littleendtitle" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">表格开头特征</label>
                           <input type="text" class="form-control model" id="tabbegin" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">表格结尾特征</label>
                           <input type="text" class="form-control model" id="tabend" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">图片开头特征</label>
                           <input type="text" class="form-control model" id="imgbegin" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">图片结尾特征</label>
                           <input type="text" class="form-control model" id="imgend" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">主题开头特征</label>
                           <input type="text" class="form-control model" id="topicalbegin" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">主题结尾特征</label>
                           <input type="text" class="form-control model" id="topicalend" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                       <div class="form-group">
                           <label for="zhiwei">正文内说明开头特征</label>
                           <input type="text" class="form-control model" id="description" placeholder="若不需要抽取或没有则不需要填写">
                       </div>
                   </form>
               </div>
               <div class="modal-footer">
                   <button type="button" class="btn btn-default quxiao-tianjia" data-dismiss="modal">取消</button>
                   <button type="button" class="btn btn-primary Docreate" data-dismiss="modal">使用该模板运行</button>
               </div>
           </div>
       </div>
   </div>-->

   <!--等待的Model-->
   <!--<div class="modal fade" id="wait" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content" id="result">
            <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                   <h4 class="modal-title">请稍等片刻</h4>
            </div>
              <div class="modal-body">
                <div class="loader-inner line-scale-pulse-out-rapid" style="position: absolute; left: 45%;">
                  <div></div>
                  <div></div>
                  <div></div>
                  <div></div>
                  <div></div>
                </div>
                  <br>
                  <br>
                  <p>程序正在运行中，请等待片刻。在完成后，会有弹窗显示。</p>
              </div>

        </div>
      </div>
    </div>-->


    <!--sorry的Model-->
       <!--<div class="modal fade" id="sorry" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                   <h4 class="modal-title">Sorry</h4>
                </div>
                  <div class="modal-body">
                      <p>抱歉，上一个算法还在运行中，请等待上一次运行完成。在进行下一次的运行。</p>
                  </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-secondary" data-dismiss="modal">确定</button>
               </div>
            </div>
          </div>
        </div>-->



</body>
<script>
    var toggle = true;

    $(".sidebar-icon").click(function () {
        if (toggle) {
            $(".page-container").addClass("sidebar-collapsed").removeClass("sidebar-collapsed-back");
            $("#menu span").css({"position": "absolute"});
        }
        else {
            $(".page-container").removeClass("sidebar-collapsed").addClass("sidebar-collapsed-back");
            setTimeout(function () {
                $("#menu span").css({"position": "relative"});
            }, 400);
        }

        toggle = !toggle;
    });
</script>
<!--js -->
<!-- <script src="js/jquery.nicescroll.js"></script>
<script src="js/scripts.js"></script> -->
<!-- Bootstrap Core JavaScript -->
   	<script>
    $("#file-1").fileinput({
        language: "zh",
        uploadUrl: '/upload/', // you must set a valid URL here else you will get an error
        allowedFileExtensions: [],//不限格式
        overwriteInitial: false,
        maxFileSize: 10000,
        maxFilesNum: 10,
        allowedFileTypes: ['html'],
        layoutTemplates: {
            actions: '',
        },
        slugCallback: function (filename) {
            return filename.replace('(', '_').replace(']', '_');
        },
        previewTemplates:{
            html:'<div class="file-preview-frame krajee-default  kv-preview-thumb" id="{previewId}" data-fileindex="0" data-template="{template}" title=""><div class="kv-file-content">\n' +
            '<div class="kv-preview-data file-preview-other-frame" style="width:213px;height:160px;">\n' +
            '<div class="file-preview-other">\n' +
            '<span class="file-other-icon"><i class="glyphicon glyphicon-file"></i></span>\n' +
            '</div>\n' +
            '</div>\n'+
            '<div class="file-thumbnail-footer">\n' +
            '    <div class="file-footer-caption" title="{caption}">\n' +
            '        <div class="file-caption-info">{caption}</div>\n' +
            '        <div class="file-size-info"> <samp></samp></div>\n' +
            '    </div>\n' +
            '    <div class="file-thumb-progress kv-hidden"><div class="progress">\n' +
            '    <div class="progress-bar bg-success progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%;">\n' +
            '        Initializing...\n' +
            '     </div>\n' +
            '</div></div>\n' +
            '<div class="file-upload-indicator" title="Not uploaded yet"><i class="glyphicon glyphicon-plus-sign text-warning"></i></div>\n' +
            '<div class="file-actions">\n' +
            '    <div class="file-footer-buttons">\n' +
            '           <br>\n' +
            '</div>\n' +
            '\n' +
            '<div class="clearfix"></div>\n' +
            '</div>'
        } ,

    });
	</script>
   <script>
       // 首先打开选择文件的modal
       $('#doexe').attr({
           'data-toggle': 'modal',
           'data-target': '#choose_file'
       });

       // 点击运行函数按钮
       $('#doexe').click(function () {
           $("#result").empty();
           $("<div class=\"modal-header\">\n" +
               "                   <button type=\"button\" class=\"close\" data-dismiss=\"modal\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>\n" +
               "                   <h4 class=\"modal-title\">Please wait a moment</h4>\n" +
               "            </div>\n" +
               "              <div class=\"modal-body\">\n" +
               "                <div class=\"loader-inner line-scale-pulse-out-rapid\" style=\"position: absolute; left: 45%;\">\n" +
               "                  <div></div>\n" +
               "                  <div></div>\n" +
               "                  <div></div>\n" +
               "                  <div></div>\n" +
               "                  <div></div>\n" +
               "                </div>\n" +
               "                  <br>\n" +
               "                  <br>\n" +
               "                  <p>The program is currently running. Please wait a moment and try not to close this dialog box. You will be notified when the program has finished running.</p>\n" +
               "              </div>").appendTo($("#result"));

           //先清空选择文件的modal的modalbody的子元素
           if ($("#file_body").children('a').length!=0){
                $("#file_body").empty();
           }
           //获取后台模板的文件名
           $.ajax({
              type:"POST",
              url:"/getfilename/",
              success:function (data) {
                  data = JSON.parse(data);
                  for(var i = 0;i<data["filenum"];i++){
                      $("<a style='color:#333;cursor:pointer' class='filemodel' onclick='checkfile(this)'><img src='/static/img/file.png'> <div class=\"file-caption-info\" style='font-size:15px'>"+data["filename"][i]+"</div></div></a>").appendTo($("#file_body"))
                  }
              }
           });

       });

       // 打开创建新模板的modal
           $(".createModel").click(function () {
               $(this).attr({
                   'data-toggle': 'modal',
                   'data-target': '#createModel'
               })
           });

            // Doexe，打开选择解析模版的modal
           $(".Doexe").click(function () {

               // 运行函数
               var activea = $("#file_body").find(".active");
               if(activea.length>0) {
                   var filename = new Array();
                   //将选中文件文件名放到数组中
                   for (var i = 0; i < activea.length; i++) {
                       var $activetemp = $(activea[i]);
                       console.log($activetemp.find(".file-caption-info").html());
                       filename[i] = $activetemp.find(".file-caption-info").html();
                   }

                   //将文件名数组传递给后台
                   $.ajax({
                       type: "POST",
                       url: '/choose_file/',
                       data: {"filename": JSON.stringify(filename)},
                       success: function (data) {
                           filename.splice(0, filename.length);
                           console.log(data);
                       }

                   });

                   $(this).attr({
                       'data-toggle': 'modal',
                       'data-target': '#Doexe'
                   });

               }else{
                   alert("You haven't selected a webpage for parsing. Please choose a webpage.");

                   /*$(this).attr({
                       'data-toggle': 'modal',
                       'data-target': '#choose_file'
                   });*/
                   //$('#choose_file').modal('toggle');
               }
           });


       // 运行算法函数
           $(".Do").click(function () {
               var activea = $("#model_body").find(".active");
               if(activea.length>0) {
                   var filename = new Array();
                   //将选中文件文件名放到数组中
                   for (var i = 0; i < activea.length; i++) {
                       var $activetemp = $(activea[i]);
                       console.log($activetemp.find(".file-caption-info").html());
                       filename[i] = $activetemp.find(".file-caption-info").html();
                   }
                   //清空modelbody的子元素
                   /*if ($(".modal-body").children('a').length != 0) {
                       $(".modal-body").empty();
                   }*/

                   //开始显示等待画面
                   $(this).attr({
                       'data-toggle': 'modal',
                       'data-target': '#wait'
                   });
                   //$('.line-scale-pulse-out-rapid').css('display','block');
                   // 在上一个算法程序没有完成前，不能进行下一轮的使用
                   $("#doexe").attr({
                       'data-target': '#sorry'
                   });

                   //将文件名数组传递给后台
                   $.ajax({
                       type: "POST",
                       url: '/Doexe/',
                       data: {"filename": JSON.stringify(filename)},
                       success: function (data) {
                           //filename.splice(0, filename.length);
                           //console.log(data);
                           data = JSON.parse(data);
                           console.log('The number of generated QA pairs：'+data['num']);
                           //console.log(data['qa'][0]['question']);
                           for (i = 0 ; i < data['qa'].length ; i++){
                               console.log('The questions of the generated QA pairs：'+data['qa'][i]['question']);
                           }
                           // $('#wait').removeAttr('data-toggle');
                           // alert('完成');
                           //$("#wait").css('display','none');
                           //modal('hide');

                           $("#result").empty();
                           //显示完成
                           alert("Execution completed. A total of"+data['num']+"QA pairs were generated this time.");

                           $("               <div class=\"modal-header\">\n" +
                               "                   <button type=\"button\" class=\"close\" data-dismiss=\"modal\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>\n" +
                               "                   <h4 class=\"modal-title\">Execution completed</h4>\n" +
                               "               </div>\n" +
                               "               <div class=\"modal-body\" id=\"model_body\">\n" +
                               "                  <p>A total of"+ data['num']+"QA pairs were generated this time</p>\n" +
                               "                  <a href='/show_result' target = '_blank' style='cursor:pointer'>Click to view the results of this run</a>"+
                               "               </div>\n" +
                               "               <div class=\"modal-footer\">\n" +
                               "                   <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">Confirm</button>\n" +
                               "               </div>\n" +
                               "           </div>\n").appendTo($("#result"));
                           $("#doexe").attr({
                               'data-target': '#choose_file'
                           });
                       }

                   });
               }else{
                   alert("You haven't selected a webpage extraction template. Please choose a suitable template or create a new one.");
               }
           });
       // 选择模版的函数

       function checkfile(checka) {
           var $checka = $(checka);
           if($checka.hasClass("active")){
               $checka.removeClass("active");
               checka.removeChild(checka.childNodes[0]);

           }
           else{
               $checka.addClass("active");
               $checka.prepend($("<i class=\"glyphicon glyphicon-ok-sign text-success\" style='float:right;margin-top:4%'></i>"));
           }
       }

       $(".Docreate").click(function () {
           var msg={};
           msg["begintitle"] = $("#begintitle").val();
           msg["endtitle"] = $("#endtitle").val();
           msg["littlebegintitle"] = $("#littlebegintitle").val();
           msg["littleendtitle"] = $("#littleendtitle").val();
           msg["tabbegin"] = $("#tabbegin").val();
           msg["tabend"] = $("#tabend").val();
           msg["imgbegin"] = $("#imgbegin").val();
           msg["imgend"] = $("#imgend").val();
           msg["topicalbegin"] = $("#topicalbegin").val();
           msg["topicalend"] = $("#topicalend").val();
           msg["description"] = $("#description").val();

           console.log(msg);
           //开始显示等待画面
                   $(this).attr({
                       'data-toggle': 'modal',
                       'data-target': '#wait'
                   });
                   //$('.line-scale-pulse-out-rapid').css('display','block');
                   // 在上一个算法程序没有完成前，不能进行下一轮的使用
                   $("#doexe").attr({
                       'data-target': '#sorry'
                   });
           $.ajax({
               type:"POST",
               url:"/create_model/",
               data:{"createdata":JSON.stringify(msg)},
               success:function (data) {
                            //filename.splice(0, filename.length);
                           //console.log(data);
                           data = JSON.parse(data);
                           console.log('The number of generated QA pairs：'+data['num']);
                           //console.log(data['qa'][0]['question']);
                           for (i = 0 ; i < data['qa'].length ; i++){
                               console.log('The questions of the generated QA pairs：'+data['qa'][i]['question']);
                           }
                           // $('#wait').removeAttr('data-toggle');
                           // alert('完成');
                           //$("#wait").css('display','none');
                           //modal('hide');

                           $("#result").empty();
                           //显示完成
                           alert("Execution completed. A total of"+data['num']+"QA pairs were generated this time.");

                           $("               <div class=\"modal-header\">\n" +
                               "                   <button type=\"button\" class=\"close\" data-dismiss=\"modal\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>\n" +
                               "                   <h4 class=\"modal-title\">Execution completed</h4>\n" +
                               "               </div>\n" +
                               "               <div class=\"modal-body\" id=\"model_body\">\n" +
                               "                  <p>A total of"+ data['num']+"QA pairs were generated this time</p>\n" +
                               "                  <a href='/show_result' target = '_blank' style='cursor:pointer'>Click to view the results of this run</a>"+
                               "               </div>\n" +
                               "               <div class=\"modal-footer\">\n" +
                               "                   <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">Confirm</button>\n" +
                               "               </div>\n" +
                               "           </div>\n").appendTo($("#result"));
                           $("#doexe").attr({
                               'data-target': '#choose_file'
                           });
                       }

           });
       });
   </script>
   <!-- /Bootstrap Core JavaScript -->
   <!-- real-time -->
<!-- <script language="javascript" type="text/javascript" src="js/jquery.flot.js"></script> -->
<!-- /real-time -->
<!-- <script src="{% static 'js/jquery.fn.gantt.js' %}"></script>
<script src="{% static 'js/menu_jquery.js' %}"></script> -->
</body>
</html>